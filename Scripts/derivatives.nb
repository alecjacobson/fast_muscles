(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62801,       1686]
NotebookOptionsPosition[     56568,       1571]
NotebookOutlinePosition[     56902,       1586]
CellTagsIndexPosition[     56859,       1583]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.751220132747696*^9, 3.751220135881892*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"f3551e42-c888-408e-9b4a-7deb4bd0c2c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strains", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "s1", ",", " ", "s2", ",", " ", "s3", ",", " ", "s4", ",", " ", "s5", ",",
      " ", "s6", ",", " ", "s7", ",", " ", "s8", ",", " ", "s9"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.7512203891587267`*^9, {3.751220426301598*^9, 3.751220441756156*^9}, {
   3.751220991823373*^9, 3.751220992480031*^9}, {3.765558330662418*^9, 
   3.765558332893462*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"4dc99fde-3394-4374-a719-d7cedd8da85c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "s_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", 
       RowBox[{"s", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", "8", "]"}], "]"}], ",", " ", 
       RowBox[{"s", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "[", "s_", "]"}], ":=", " ", 
   RowBox[{"Det", "[", 
    RowBox[{"c", "[", "s", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1", "[", "s_", "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"c", "[", "s", "]"}], "]"}], ".", 
     RowBox[{"c", "[", "s", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1bar", "[", "s_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Power", "[", " ", 
     RowBox[{
      RowBox[{"J", "[", "s", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"-", "2.0"}], "/", "3.0"}]}], "]"}], "*", 
    RowBox[{"I1", "[", "s", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "s_", "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"0.5", "*", "C1", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"I1", "[", "s", "]"}], " ", "-", " ", "3"}], ")"}]}], " ", "+",
     " ", 
    RowBox[{"0.5", "*", "D1", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"c", "[", "s", "]"}], "]"}], " ", "-", " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"(", 
           RowBox[{"C1", "/", "D1"}], ")"}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"C1", "/", 
            RowBox[{"(", 
             RowBox[{"D1", "*", "4.0"}], ")"}]}], ")"}]}], ")"}]}], " ", 
       ")"}], "^", "2"}]}], "   ", "-", " ", 
    RowBox[{"0.5", "*", "C1", "*", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"I1", "[", "s", "]"}], " ", "+", " ", "1"}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7512202788742857`*^9, 3.7512203006112022`*^9}, {
   3.7512204819816017`*^9, 3.751220517634478*^9}, {3.7512205842520647`*^9, 
   3.751220680822424*^9}, {3.751220750574325*^9, 3.751220819130505*^9}, {
   3.751220928453671*^9, 3.751220938917366*^9}, {3.751653579158841*^9, 
   3.751653633658552*^9}, {3.751653997571261*^9, 3.751654013204267*^9}, {
   3.751654060367712*^9, 3.7516541054263783`*^9}, 3.751654774374473*^9, {
   3.7516574153580933`*^9, 3.751657422252248*^9}, {3.753552279903994*^9, 
   3.7535522836926527`*^9}, {3.753565547111404*^9, 3.753565560358047*^9}, {
   3.75356770051659*^9, 3.75356770086166*^9}, {3.753567833160269*^9, 
   3.753567833564424*^9}, {3.761496483792392*^9, 3.761496500297018*^9}, {
   3.761496533887106*^9, 3.7614966045327387`*^9}, {3.7615009624690123`*^9, 
   3.761501007630639*^9}, {3.761501041780773*^9, 3.761501044488556*^9}, {
   3.765558368590395*^9, 3.765558382188074*^9}, {3.765558923370596*^9, 
   3.765558923934249*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2e9faad2-c0fc-48b2-9fb2-d5691a481547"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1", "[", "strains", "]"}]], "Input",
 CellChangeTimes->{{3.7538183540531063`*^9, 3.753818364865795*^9}, {
  3.753818515356174*^9, 3.753818516620084*^9}, {3.753818621134981*^9, 
  3.753818635473979*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a4b124a9-47ab-45bb-ad64-486218d220ad"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["s1", "2"], "+", 
  SuperscriptBox["s2", "2"], "+", 
  SuperscriptBox["s3", "2"], "+", 
  SuperscriptBox["s4", "2"], "+", 
  SuperscriptBox["s5", "2"], "+", 
  SuperscriptBox["s6", "2"], "+", 
  SuperscriptBox["s7", "2"], "+", 
  SuperscriptBox["s8", "2"], "+", 
  SuperscriptBox["s9", "2"]}]], "Output",
 CellChangeTimes->{
  3.753818365559383*^9, 3.753818517189415*^9, {3.753818628088007*^9, 
   3.75381863716648*^9}, {3.757902836686357*^9, 3.757902860134609*^9}, 
   3.761496609975874*^9, {3.761500948416852*^9, 3.7615009658797903`*^9}, 
   3.761501010812902*^9, 3.761501046798594*^9, 3.765558395616804*^9, 
   3.765558930073843*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"9804a146-abc8-46b7-ae7d-20ae0b3367fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J", "[", "strains", "]"}]], "Input",
 CellChangeTimes->{{3.7538235381763163`*^9, 3.7538235401388187`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"614bc305-be08-4e1f-a5d0-4fd9f5c6933c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "s3"}], " ", "s5", " ", "s7"}], "+", 
  RowBox[{"s2", " ", "s6", " ", "s7"}], "+", 
  RowBox[{"s3", " ", "s4", " ", "s8"}], "-", 
  RowBox[{"s1", " ", "s6", " ", "s8"}], "-", 
  RowBox[{"s2", " ", "s4", " ", "s9"}], "+", 
  RowBox[{"s1", " ", "s5", " ", "s9"}]}]], "Output",
 CellChangeTimes->{
  3.753823540861843*^9, {3.757902836731142*^9, 3.757902860181552*^9}, 
   3.761496610003852*^9, {3.7615009484467287`*^9, 3.761500965917762*^9}, 
   3.761501010849373*^9, 3.761501046834566*^9, 3.765558408013236*^9, 
   3.765558931204454*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"d3ff305c-a606-4fba-9364-d42a9a4c8e4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"c", "[", "strains", "]"}], "]"}], ".", 
   RowBox[{"c", "[", "strains", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7538183996005697`*^9, 3.7538184243406553`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"e25b27fd-2b3a-42cd-9659-899d6a921f15"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["s1", "2"], "+", 
       SuperscriptBox["s4", "2"], "+", 
       SuperscriptBox["s7", "2"]}], 
      RowBox[{
       RowBox[{"s1", " ", "s2"}], "+", 
       RowBox[{"s4", " ", "s5"}], "+", 
       RowBox[{"s7", " ", "s8"}]}], 
      RowBox[{
       RowBox[{"s1", " ", "s3"}], "+", 
       RowBox[{"s4", " ", "s6"}], "+", 
       RowBox[{"s7", " ", "s9"}]}]},
     {
      RowBox[{
       RowBox[{"s1", " ", "s2"}], "+", 
       RowBox[{"s4", " ", "s5"}], "+", 
       RowBox[{"s7", " ", "s8"}]}], 
      RowBox[{
       SuperscriptBox["s2", "2"], "+", 
       SuperscriptBox["s5", "2"], "+", 
       SuperscriptBox["s8", "2"]}], 
      RowBox[{
       RowBox[{"s2", " ", "s3"}], "+", 
       RowBox[{"s5", " ", "s6"}], "+", 
       RowBox[{"s8", " ", "s9"}]}]},
     {
      RowBox[{
       RowBox[{"s1", " ", "s3"}], "+", 
       RowBox[{"s4", " ", "s6"}], "+", 
       RowBox[{"s7", " ", "s9"}]}], 
      RowBox[{
       RowBox[{"s2", " ", "s3"}], "+", 
       RowBox[{"s5", " ", "s6"}], "+", 
       RowBox[{"s8", " ", "s9"}]}], 
      RowBox[{
       SuperscriptBox["s3", "2"], "+", 
       SuperscriptBox["s6", "2"], "+", 
       SuperscriptBox["s9", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.753818424972081*^9, {3.7579028367708673`*^9, 3.757902860226132*^9}, 
   3.76149661003337*^9, {3.761500948474121*^9, 3.761500965949706*^9}, 
   3.761501010879723*^9, 3.761501046866251*^9, 3.765558419353513*^9, 
   3.7655589322776117`*^9},
 CellLabel->
  "Out[32]//MatrixForm=",ExpressionUUID->"8cd06397-cd68-4e4d-852f-\
9327d3d97a35"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dWds", "[", "s_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"W", "[", "strains", "]"}], ",", " ", 
       RowBox[{"{", "strains", "}"}]}], "]"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"strains", " ", "\[Rule]", "s"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.751220907348707*^9, 3.751220922025818*^9}, {
  3.751220955430299*^9, 3.75122101836556*^9}, {3.7535567442006197`*^9, 
  3.7535567491451473`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"9925d819-6e14-4f4d-a44f-65e050447c68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"C1", " ", "=", 
    RowBox[{"60000", "/", 
     RowBox[{"(", 
      RowBox[{"2.0", "*", 
       RowBox[{"(", 
        RowBox[{"1.0", "+", "0.45"}], ")"}]}], ")"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D1", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"60000", "*", "0.45"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0", "+", "0.45"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1.0", "-", 
        RowBox[{"2.0", "*", "0.45"}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"snew", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"W", "[", "snew", "]"}]}], "Input",
 CellChangeTimes->{{3.751221022592911*^9, 3.75122102578146*^9}, {
   3.7535651452029753`*^9, 3.753565188379203*^9}, 3.753565281489778*^9, 
   3.753566340460705*^9, {3.753566418352508*^9, 3.753566418498167*^9}, {
   3.75356647321404*^9, 3.753566474908143*^9}, {3.753567156887126*^9, 
   3.753567161827594*^9}, {3.76150078285367*^9, 3.7615007873799887`*^9}, {
   3.761500821907042*^9, 3.761500824384809*^9}, {3.761500884244516*^9, 
   3.7615009467758627`*^9}, {3.761501252282342*^9, 3.761501261927719*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"e59d97cc-d4f2-4957-8e3e-f9805f8e25eb"],

Cell[BoxData[
 RowBox[{"-", "13694.424425378176`"}]], "Output",
 CellChangeTimes->{
  3.7512210273676567`*^9, 3.751654122013403*^9, 3.751654776709509*^9, 
   3.7516574246877327`*^9, 3.751658587355734*^9, 3.75355226011025*^9, 
   3.753552421920218*^9, 3.753556750736446*^9, 3.75356510438055*^9, {
   3.7535651699863987`*^9, 3.753565189489438*^9}, 3.7535652833101788`*^9, 
   3.75356556437006*^9, 3.7535661194907618`*^9, 3.753566212716345*^9, {
   3.7535662752100697`*^9, 3.753566292463092*^9}, {3.7535663421351757`*^9, 
   3.753566353306489*^9}, 3.753566420703857*^9, {3.753566476736112*^9, 
   3.7535664890655003`*^9}, {3.753567157780554*^9, 3.7535671624180107`*^9}, 
   3.753567702894866*^9, 3.753567835337695*^9, 3.753818342038117*^9, {
   3.757902836939863*^9, 3.757902860399345*^9}, 3.761496610371908*^9, {
   3.7615007851969557`*^9, 3.761500792377943*^9}, {3.761500948505488*^9, 
   3.761500965994277*^9}, 3.7615010109304657`*^9, 3.7615010469083557`*^9, 
   3.7615012628588457`*^9},
 CellLabel->
  "Out[314]=",ExpressionUUID->"19d0427b-862d-41e4-a3e6-557bf996f1bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"E0", " ", "=", " ", 
  RowBox[{"W", "[", "snew", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", " ", "=", " ", "0.00000001"}], ";"}]}], "Input",
 CellChangeTimes->{{3.753566087976975*^9, 3.753566092842141*^9}, {
   3.7535662411707067`*^9, 3.753566248307109*^9}, {3.7535662863496313`*^9, 
   3.753566290935965*^9}, 3.753566352042118*^9, {3.7535664876837673`*^9, 
   3.753566487810958*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"d3a25e56-78da-4edc-ae63-ec8d1d1f846f"],

Cell[BoxData[
 RowBox[{"-", "13862.742568991831`"}]], "Output",
 CellChangeTimes->{
  3.753566119519259*^9, 3.753566212743166*^9, {3.7535662752363663`*^9, 
   3.753566292487548*^9}, {3.753566342166971*^9, 3.7535663533315487`*^9}, 
   3.7535664207341633`*^9, {3.7535664767628317`*^9, 3.753566489091949*^9}, {
   3.7535671521270313`*^9, 3.75356716346954*^9}, 3.753567702926013*^9, 
   3.753567835371277*^9, 3.75381834207038*^9, {3.757902836978203*^9, 
   3.757902860437882*^9}, 3.761496610424259*^9, 3.761500801721561*^9, {
   3.761500948524466*^9, 3.761500966026285*^9}, 3.761501010970627*^9, 
   3.76150104692772*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"31b94d21-08a7-4d90-a4e0-8a0dd1733620"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["E0"], "Input",
 CellChangeTimes->{{3.7615008056827917`*^9, 3.761500806112585*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"1ba4455c-b4ba-4506-830e-80ba1223ffb5"],

Cell[BoxData[
 RowBox[{"-", "13862.742568991831`"}]], "Output",
 CellChangeTimes->{
  3.761500806813188*^9, {3.761500948552814*^9, 3.761500966056511*^9}, 
   3.761501011002499*^9, 3.7615010469448*^9},
 CellLabel->
  "Out[269]=",ExpressionUUID->"30c7ee84-cef6-4a08-adb7-4dd98db5bc75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J", "[", "snew", "]"}]], "Input",
 CellChangeTimes->{{3.753567390399178*^9, 3.753567393591239*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"ca434772-4896-4563-bda4-8d8ce1619013"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.753567394563678*^9, 3.753567702954296*^9, 3.7535678354001493`*^9, 
   3.7538183421008387`*^9, {3.757902837013092*^9, 3.757902860473855*^9}, 
   3.7614966104477882`*^9, {3.7615009485802937`*^9, 3.7615009660865088`*^9}, 
   3.761501011033545*^9, 3.7615010469739122`*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"cb369bfc-1a97-4ec4-ac1c-b08a23da9db4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1", "[", "snew", "]"}]], "Input",
 CellChangeTimes->{{3.753567395974036*^9, 3.753567400740226*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"5024fabe-3a4f-4fb0-b573-61f770e51167"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{
  3.753567401576785*^9, 3.753567702983684*^9, 3.753567835428899*^9, 
   3.753818342131793*^9, {3.757902837051341*^9, 3.7579028605064363`*^9}, 
   3.7614966104719257`*^9, {3.7615009486084557`*^9, 3.761500966118668*^9}, 
   3.7615010110649548`*^9, 3.7615010470030737`*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"a2ef50db-f368-467a-bc3e-abe5f4368f6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1bar", "[", "snew", "]"}]], "Input",
 CellChangeTimes->{{3.7535674088341208`*^9, 3.7535674122692823`*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"2ed1cf78-afa3-458a-bd99-c09442ada98e"],

Cell[BoxData["3.`"], "Output",
 CellChangeTimes->{
  3.753567412931404*^9, 3.753567703015737*^9, 3.753567835460137*^9, 
   3.753818342163535*^9, {3.757902837057025*^9, 3.7579028605393744`*^9}, 
   3.761496610495607*^9, {3.7615009486379137`*^9, 3.761500966151958*^9}, 
   3.761501011099627*^9, 3.761501047032922*^9},
 CellLabel->
  "Out[272]=",ExpressionUUID->"0a9d8be7-232b-4b00-89f9-7f2928580908"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", "snew", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7535675136241817`*^9, 3.7535675305062027`*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"5527f0df-894f-41be-a4db-b9a0f54201a0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.753567531106777*^9, 3.753567703049369*^9, 3.753567835492367*^9, 
   3.753818342195549*^9, {3.757902837094261*^9, 3.757902860572069*^9}, 
   3.761496610519442*^9, {3.761500948668063*^9, 3.761500966185812*^9}, 
   3.761501011131686*^9, 3.761501047062875*^9},
 CellLabel->
  "Out[273]//MatrixForm=",ExpressionUUID->"34514324-516a-497c-af04-\
c62ea930b5ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"c", "[", "snew", "]"}], "]"}], "*", 
   RowBox[{"c", "[", "snew", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.753567541158874*^9, 3.753567568728877*^9}, {
  3.753567695298122*^9, 3.753567695735572*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"09589082-58e7-4704-91bc-f621a037e9db"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.75356756473356*^9, 3.753567569164283*^9}, {
   3.753567696632653*^9, 3.753567703082121*^9}, 3.753567835522613*^9, 
   3.7538183422264957`*^9, {3.757902837130522*^9, 3.757902860605047*^9}, 
   3.761496610544386*^9, {3.761500948699295*^9, 3.761500966215395*^9}, 
   3.761501011162691*^9, 3.761501047094598*^9},
 CellLabel->
  "Out[274]//MatrixForm=",ExpressionUUID->"34b7a7e5-d4b5-46fe-b253-\
f2772db9da01"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "eps"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", "eps"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "-", "eps"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g4", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "-", "eps"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g5", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "-", "eps"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "+", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g6", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"W", "[", "snew", "]"}], "-", "E0"}], ")"}], "/", "eps"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snew", "[", 
     RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"snew", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "-", "eps"}]}], ";"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.75356601572473*^9, 3.753566196988696*^9}, {
  3.753566229966323*^9, 3.753566271674932*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"877e3692-50bf-44cd-a2ff-fb92977a6f4b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "g1", ",", " ", "g2", ",", " ", "g3", ",", " ", "g4", ",", " ", "g5", ",", 
   " ", "g6"}], "}"}]], "Input",
 CellChangeTimes->{{3.753566201800064*^9, 3.753566209066533*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"baf6e5d5-4909-4971-b980-02ae16a36d0f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.500040187034756`", ",", "0.5002220859751105`", ",", 
   "0.49985828809440136`", ",", "0.00018189894035458565`", ",", 
   "0.00018189894035458565`", ",", "0.00018189894035458565`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.753566212777412*^9, {3.753566275271041*^9, 3.753566292513706*^9}, {
   3.7535663422010593`*^9, 3.753566353360037*^9}, 3.7535664207695503`*^9, {
   3.7535664767880497`*^9, 3.753566489119858*^9}, 3.7535677031170797`*^9, 
   3.753567835558159*^9, {3.757902837177566*^9, 3.757902860651671*^9}, 
   3.761496610572878*^9, {3.761500948733773*^9, 3.761500966252418*^9}, 
   3.7615010112543173`*^9, 3.7615010471356163`*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"2a129098-a750-467d-85f1-1362ba4833b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["snew"], "Input",
 CellChangeTimes->{{3.753566128324041*^9, 3.753566129162839*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"d403d39c-a17d-4050-9587-8f1a60c2302c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9999999999999999`", ",", "0.9999999999999999`", ",", 
   "0.9999999999999999`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.753566130164728*^9, 3.75356621280068*^9, {3.7535662752937*^9, 
   3.753566292535451*^9}, {3.753566342228294*^9, 3.753566353381721*^9}, 
   3.753566420796301*^9, {3.753566476812429*^9, 3.753566489142555*^9}, 
   3.753567703149802*^9, 3.7535678355927277`*^9, 3.753818342266288*^9, {
   3.7579028372129087`*^9, 3.757902860687764*^9}, 3.761496610599059*^9, {
   3.7615009487635117`*^9, 3.7615009662824507`*^9}, 3.761501011275813*^9, 
   3.7615010471402483`*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"6d9c10d6-7f32-43bb-b906-a3561384532b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"dWds", "[", "strains", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.751221377624215*^9, 3.75122138141181*^9}, {
  3.753567742859002*^9, 3.753567749895413*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"09640e9b-3a2e-461a-b824-efb807472d38"],

Cell["\<\
List(1.*C1*s1 - (1.*C1*s1)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + \
Power(s4,2) + Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + \
Power(s9,2)) + 
    1.*(s6*s8 - 1.*s5*s9)*(0.75*C1 + D1*(1 + s3*s5*s7 - 1.*s2*s6*s7 - \
1.*s3*s4*s8 + s1*s6*s8 + s2*s4*s9 - 1.*s1*s5*s9)),
   1.*C1*s2 + 1.*D1*(s6*s7 - s4*s9)*(-1 - (0.75*C1)/D1 - s3*s5*s7 + s2*s6*s7 \
+ s3*s4*s8 - s1*s6*s8 - s2*s4*s9 + s1*s5*s9) - 
    (1.*C1*s2)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + Power(s4,2) + \
Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + Power(s9,2)),
   1.*C1*s3 - (1.*C1*s3)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + \
Power(s4,2) + Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + \
Power(s9,2)) + 
    1.*(s5*s7 - 1.*s4*s8)*(0.75*C1 + D1*(1 + s3*s5*s7 - 1.*s2*s6*s7 - \
1.*s3*s4*s8 + s1*s6*s8 + s2*s4*s9 - 1.*s1*s5*s9)),
   1.*C1*s4 + 1.*D1*(s3*s8 - s2*s9)*(-1 - (0.75*C1)/D1 - s3*s5*s7 + s2*s6*s7 \
+ s3*s4*s8 - s1*s6*s8 - s2*s4*s9 + s1*s5*s9) - 
    (1.*C1*s4)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + Power(s4,2) + \
Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + Power(s9,2)),
   1.*C1*s5 - (1.*C1*s5)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + \
Power(s4,2) + Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + \
Power(s9,2)) + 
    1.*(s3*s7 - 1.*s1*s9)*(0.75*C1 + D1*(1 + s3*s5*s7 - 1.*s2*s6*s7 - \
1.*s3*s4*s8 + s1*s6*s8 + s2*s4*s9 - 1.*s1*s5*s9)),
   1.*C1*s6 + 1.*D1*(s2*s7 - s1*s8)*(-1 - (0.75*C1)/D1 - s3*s5*s7 + s2*s6*s7 \
+ s3*s4*s8 - s1*s6*s8 - s2*s4*s9 + s1*s5*s9) - 
    (1.*C1*s6)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + Power(s4,2) + \
Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + Power(s9,2)),
   1.*C1*s7 - (1.*C1*s7)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + \
Power(s4,2) + Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + \
Power(s9,2)) + 
    1.*(s3*s5 - 1.*s2*s6)*(0.75*C1 + D1*(1 + s3*s5*s7 - 1.*s2*s6*s7 - \
1.*s3*s4*s8 + s1*s6*s8 + s2*s4*s9 - 1.*s1*s5*s9)),
   1.*C1*s8 + 1.*D1*(s3*s4 - s1*s6)*(-1 - (0.75*C1)/D1 - s3*s5*s7 + s2*s6*s7 \
+ s3*s4*s8 - s1*s6*s8 - s2*s4*s9 + s1*s5*s9) - 
    (1.*C1*s8)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + Power(s4,2) + \
Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + Power(s9,2)),
   1.*C1*s9 - (1.*C1*s9)/(1 + Power(s1,2) + Power(s2,2) + Power(s3,2) + \
Power(s4,2) + Power(s5,2) + Power(s6,2) + Power(s7,2) + Power(s8,2) + \
Power(s9,2)) + 
    1.*(s2*s4 - 1.*s1*s5)*(0.75*C1 + D1*(1 + s3*s5*s7 - 1.*s2*s6*s7 - \
1.*s3*s4*s8 + s1*s6*s8 + s2*s4*s9 - 1.*s1*s5*s9)))\
\>", "Output",
 CellChangeTimes->{
  3.751221382708152*^9, 3.75165412868325*^9, 3.751654776733716*^9, 
   3.751657424715012*^9, 3.7516585873835287`*^9, 3.753552260144232*^9, 
   3.7535524219595003`*^9, 3.7535567507697277`*^9, 3.753565104417164*^9, 
   3.7535651700198936`*^9, 3.753565564401022*^9, 3.7535661195767803`*^9, 
   3.753566212805521*^9, {3.753566275316703*^9, 3.7535662925585203`*^9}, {
   3.753566342258012*^9, 3.753566353403757*^9}, 3.753566420801285*^9, {
   3.7535664768365803`*^9, 3.7535664891649847`*^9}, 3.753567703180924*^9, 
   3.7535677514392548`*^9, 3.753567835626319*^9, 3.753818342302342*^9, {
   3.7579028372528877`*^9, 3.757902860727508*^9}, 3.7614966106266327`*^9, {
   3.761500948944394*^9, 3.761500966376431*^9}, 3.761501011331704*^9, 
   3.761501047256012*^9, 3.765558448363275*^9, 3.765558943183415*^9},
 CellLabel->
  "Out[34]//CForm=",ExpressionUUID->"da929534-bdac-49b5-ab03-b84789e478ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"u1", ",", " ", "u2", ",", " ", "u3"}], "}"}], ".", 
  RowBox[{"c", "[", "strains", "]"}]}]], "Input",
 CellChangeTimes->{{3.753562561528034*^9, 3.7535625668652163`*^9}, {
  3.7655618167692213`*^9, 3.765561876295042*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"bff6149e-7164-4f63-b6a3-5f077ed2d343"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"s1", " ", "u1"}], "+", 
    RowBox[{"s4", " ", "u2"}], "+", 
    RowBox[{"s7", " ", "u3"}]}], ",", 
   RowBox[{
    RowBox[{"s2", " ", "u1"}], "+", 
    RowBox[{"s5", " ", "u2"}], "+", 
    RowBox[{"s8", " ", "u3"}]}], ",", 
   RowBox[{
    RowBox[{"s3", " ", "u1"}], "+", 
    RowBox[{"s6", " ", "u2"}], "+", 
    RowBox[{"s9", " ", "u3"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7655618177915173`*^9, 3.765561877316044*^9}},
 CellLabel->"Out[47]=",ExpressionUUID->"7d2f36f5-2647-45c6-b269-63f482ff46fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"muscleenergy", "[", "s_", "]"}], ":=", " ", 
   RowBox[{"0.5", "*", "a", "*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u1", ",", " ", "u2", ",", " ", "u3"}], "}"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"c", "[", "s", "]"}], "]"}], ".", 
     RowBox[{"c", "[", "s", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"u1", ",", " ", "u2", ",", " ", "u3"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muscleenergy", "[", "strains", "]"}]}], "Input",
 CellChangeTimes->{{3.751661445562077*^9, 3.751661469370715*^9}, {
  3.751661511823372*^9, 3.751661625857476*^9}, {3.751661672316785*^9, 
  3.751661676402203*^9}, {3.753826443138034*^9, 3.7538264466533546`*^9}, {
  3.757902824484707*^9, 3.757902872539434*^9}, {3.757902961514591*^9, 
  3.757903008229683*^9}, {3.757903072802326*^9, 3.75790310118738*^9}, {
  3.765561695888472*^9, 3.765561725839635*^9}, {3.7655617907051563`*^9, 
  3.7655617948096113`*^9}, {3.7655618838234043`*^9, 3.765561900098649*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"a79160d1-9306-41cd-8dd0-6ee457e539d3"],

Cell[BoxData[
 RowBox[{"0.5`", " ", "a", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"u1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s1", " ", "u1"}], "+", 
          RowBox[{"s2", " ", "u2"}], "+", 
          RowBox[{"s3", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s4", " ", "u1"}], "+", 
          RowBox[{"s5", " ", "u2"}], "+", 
          RowBox[{"s6", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s7", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s7", " ", "u1"}], "+", 
          RowBox[{"s8", " ", "u2"}], "+", 
          RowBox[{"s9", " ", "u3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"u2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s1", " ", "u1"}], "+", 
          RowBox[{"s2", " ", "u2"}], "+", 
          RowBox[{"s3", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s5", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s4", " ", "u1"}], "+", 
          RowBox[{"s5", " ", "u2"}], "+", 
          RowBox[{"s6", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s7", " ", "u1"}], "+", 
          RowBox[{"s8", " ", "u2"}], "+", 
          RowBox[{"s9", " ", "u3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"u3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s1", " ", "u1"}], "+", 
          RowBox[{"s2", " ", "u2"}], "+", 
          RowBox[{"s3", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s6", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s4", " ", "u1"}], "+", 
          RowBox[{"s5", " ", "u2"}], "+", 
          RowBox[{"s6", " ", "u3"}]}], ")"}]}], "+", 
       RowBox[{"s9", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s7", " ", "u1"}], "+", 
          RowBox[{"s8", " ", "u2"}], "+", 
          RowBox[{"s9", " ", "u3"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.753826447578665*^9, {3.757902834159783*^9, 3.757902860766424*^9}, 
   3.757903102380219*^9, 3.7614966106591587`*^9, {3.761500948983371*^9, 
   3.761500966409959*^9}, 3.761501011364048*^9, 3.761501047273234*^9, 
   3.76555847559315*^9, 3.765561623116824*^9, 3.765561727709359*^9, 
   3.765561795612905*^9, 3.7655619028048563`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"0977cdcf-75e8-431d-a5b7-4028fc974e12"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"musclegrad", "[", "s_", "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"muscleenergy", "[", "strains", "]"}], ",", " ", 
      RowBox[{"{", "strains", "}"}]}], "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"strains", " ", "\[Rule]", "s"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7516615517291393`*^9, 3.751661579239807*^9}, {
  3.751661836815344*^9, 3.751661859455357*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"9db95a6c-dbae-4168-ad08-077575ae859a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"musclegrad", "[", "strains", "]"}]], "Input",
 CellChangeTimes->{{3.75166187036975*^9, 3.751661876011984*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"50a5663d-8ce4-484f-b671-150046b3bc84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s2", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s3", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"u1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "s1", " ", "u1"}], "+", 
         RowBox[{"s2", " ", "u2"}], "+", 
         RowBox[{"s3", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s1", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s3", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s1", " ", "u1"}], "+", 
         RowBox[{"2", " ", "s2", " ", "u2"}], "+", 
         RowBox[{"s3", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s1", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"s2", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s1", " ", "u1"}], "+", 
         RowBox[{"s2", " ", "u2"}], "+", 
         RowBox[{"2", " ", "s3", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s5", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s6", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"u1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "s4", " ", "u1"}], "+", 
         RowBox[{"s5", " ", "u2"}], "+", 
         RowBox[{"s6", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s4", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s6", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s4", " ", "u1"}], "+", 
         RowBox[{"2", " ", "s5", " ", "u2"}], "+", 
         RowBox[{"s6", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s4", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"s5", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s4", " ", "u1"}], "+", 
         RowBox[{"s5", " ", "u2"}], "+", 
         RowBox[{"2", " ", "s6", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s8", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s9", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"u1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "s7", " ", "u1"}], "+", 
         RowBox[{"s8", " ", "u2"}], "+", 
         RowBox[{"s9", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s7", " ", "u1", " ", "u2"}], "+", 
      RowBox[{"s9", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s7", " ", "u1"}], "+", 
         RowBox[{"2", " ", "s8", " ", "u2"}], "+", 
         RowBox[{"s9", " ", "u3"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s7", " ", "u1", " ", "u3"}], "+", 
      RowBox[{"s8", " ", "u2", " ", "u3"}], "+", 
      RowBox[{"u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s7", " ", "u1"}], "+", 
         RowBox[{"s8", " ", "u2"}], "+", 
         RowBox[{"2", " ", "s9", " ", "u3"}]}], ")"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.751661877277854*^9, 3.753552260185679*^9, 3.753552422019318*^9, 
   3.753556750814193*^9, 3.753565104598621*^9, 3.753565170073758*^9, 
   3.75356556443978*^9, 3.753566119612461*^9, 3.753566212837226*^9, {
   3.753566275350112*^9, 3.753566292588813*^9}, {3.753566342293171*^9, 
   3.7535663534348927`*^9}, 3.753566420839435*^9, {3.753566476872224*^9, 
   3.753566489196107*^9}, 3.753567703222288*^9, 3.753567835672271*^9, 
   3.753818342350007*^9, {3.757902837402795*^9, 3.757902860793477*^9}, 
   3.7579031469352207`*^9, 3.7614966106940517`*^9, {3.761500949016522*^9, 
   3.761500966442882*^9}, 3.761501011398521*^9, 3.761501047310421*^9, 
   3.765558482810367*^9, 3.765561656778949*^9, 3.765561908985896*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"5da31b07-642a-4b3e-a467-11ddd52f7382"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.751661879014778*^9, 3.751661890673032*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"0727f47a-0ba5-4f08-80bb-7e03dd40e9d3"],

Cell["\<\
List(0.5*a*(s2*u1*u2 + s3*u1*u3 + u1*(2*s1*u1 + s2*u2 + \
s3*u3)),0.5*a*(s1*u1*u2 + s3*u2*u3 + u2*(s1*u1 + 2*s2*u2 + \
s3*u3)),0.5*a*(s1*u1*u3 + s2*u2*u3 + u3*(s1*u1 + s2*u2 + 2*s3*u3)),
   0.5*a*(s5*u1*u2 + s6*u1*u3 + u1*(2*s4*u1 + s5*u2 + s6*u3)),0.5*a*(s4*u1*u2 \
+ s6*u2*u3 + u2*(s4*u1 + 2*s5*u2 + s6*u3)),0.5*a*(s4*u1*u3 + s5*u2*u3 + \
u3*(s4*u1 + s5*u2 + 2*s6*u3)),
   0.5*a*(s8*u1*u2 + s9*u1*u3 + u1*(2*s7*u1 + s8*u2 + s9*u3)),0.5*a*(s7*u1*u2 \
+ s9*u2*u3 + u2*(s7*u1 + 2*s8*u2 + s9*u3)),0.5*a*(s7*u1*u3 + s8*u2*u3 + \
u3*(s7*u1 + s8*u2 + 2*s9*u3)))\
\>", "Output",
 CellChangeTimes->{
  3.751661892217453*^9, 3.753552260215597*^9, 3.753552422054029*^9, 
   3.753556750846465*^9, 3.7535651046302423`*^9, 3.753565170083226*^9, 
   3.753565564469305*^9, 3.7535661196409597`*^9, 3.753566212861216*^9, {
   3.753566275373747*^9, 3.753566292611047*^9}, {3.753566342319902*^9, 
   3.753566353457766*^9}, 3.753566420864964*^9, {3.753566476897243*^9, 
   3.753566489219009*^9}, 3.753567703254941*^9, 3.753567835706264*^9, 
   3.753818342385201*^9, {3.757902837447163*^9, 3.7579028608023567`*^9}, 
   3.7614966107221107`*^9, {3.7615009490435247`*^9, 3.76150096647091*^9}, 
   3.761501011426317*^9, 3.761501047340736*^9, 3.765558490128587*^9, 
   3.765561661728047*^9, 3.765561912814027*^9},
 CellLabel->
  "Out[52]//CForm=",ExpressionUUID->"653f8953-4e1b-430e-905c-1f5647f54f23"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u1", ",", " ", "u2", ",", " ", "u3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u4", ",", " ", "u5", ",", " ", "u6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u7", ",", " ", "u8", ",", " ", "u9"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r1", ",", " ", "r2", ",", " ", "r3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r4", ",", " ", "r5", ",", " ", "r6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r7", ",", " ", "r8", ",", " ", "r9"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"p1", ",", " ", "p2", ",", " ", "p3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7541691432331333`*^9, 3.754169201130142*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"641b9b7c-c0d1-4fdd-a114-cd203beee37c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"u", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.754169204202985*^9, 3.7541692182248983`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"5a036987-a83c-4d10-a11b-4d495f1efe34"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"u1", "u2", "u3"},
     {"u4", "u5", "u6"},
     {"u7", "u8", "u9"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7541692188389673`*^9, 3.7542518746784077`*^9, {3.757902837500482*^9, 
   3.757902860841341*^9}, 3.761496610752427*^9, {3.761500949075367*^9, 
   3.761500966503882*^9}, 3.761501011459249*^9, 3.761501047375284*^9},
 CellLabel->
  "Out[305]//MatrixForm=",ExpressionUUID->"e65af887-3047-4029-b62f-\
5eb1a7e45fa1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.754170467893153*^9, 3.754170469600258*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"82813bdd-0a12-41c4-bf65-a7f82417e3b0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"r1", "r2", "r3"},
     {"r4", "r5", "r6"},
     {"r7", "r8", "r9"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.754170470037429*^9, 3.7542518747053537`*^9, {3.757902837548468*^9, 
   3.757902860876122*^9}, 3.761496610776991*^9, {3.76150094910367*^9, 
   3.761500966534848*^9}, 3.761501011488661*^9, 3.7615010474047813`*^9},
 CellLabel->
  "Out[306]//MatrixForm=",ExpressionUUID->"6a85bb33-415c-4674-b7b1-\
3d65198ce486"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "u", "]"}], ".", 
   RowBox[{"Transpose", "[", "r", "]"}], ".", "p"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.754169221832849*^9, 3.7541692451678123`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"43b6e64b-668b-4381-a8ef-36c5049e0b01"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"p1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r1", " ", "u1"}], "+", 
           RowBox[{"r2", " ", "u4"}], "+", 
           RowBox[{"r3", " ", "u7"}]}], ")"}]}], "+", 
        RowBox[{"p2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r4", " ", "u1"}], "+", 
           RowBox[{"r5", " ", "u4"}], "+", 
           RowBox[{"r6", " ", "u7"}]}], ")"}]}], "+", 
        RowBox[{"p3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r7", " ", "u1"}], "+", 
           RowBox[{"r8", " ", "u4"}], "+", 
           RowBox[{"r9", " ", "u7"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"p1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r1", " ", "u2"}], "+", 
           RowBox[{"r2", " ", "u5"}], "+", 
           RowBox[{"r3", " ", "u8"}]}], ")"}]}], "+", 
        RowBox[{"p2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r4", " ", "u2"}], "+", 
           RowBox[{"r5", " ", "u5"}], "+", 
           RowBox[{"r6", " ", "u8"}]}], ")"}]}], "+", 
        RowBox[{"p3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r7", " ", "u2"}], "+", 
           RowBox[{"r8", " ", "u5"}], "+", 
           RowBox[{"r9", " ", "u8"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"p1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r1", " ", "u3"}], "+", 
           RowBox[{"r2", " ", "u6"}], "+", 
           RowBox[{"r3", " ", "u9"}]}], ")"}]}], "+", 
        RowBox[{"p2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r4", " ", "u3"}], "+", 
           RowBox[{"r5", " ", "u6"}], "+", 
           RowBox[{"r6", " ", "u9"}]}], ")"}]}], "+", 
        RowBox[{"p3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r7", " ", "u3"}], "+", 
           RowBox[{"r8", " ", "u6"}], "+", 
           RowBox[{"r9", " ", "u9"}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7541692361031847`*^9, 3.754169245574853*^9}, 
   3.7542518747276583`*^9, {3.757902837642679*^9, 3.757902860912407*^9}, 
   3.761496610782632*^9, {3.7615009491315813`*^9, 3.761500966567006*^9}, 
   3.761501011515892*^9, 3.761501047433846*^9},
 CellLabel->
  "Out[307]//MatrixForm=",ExpressionUUID->"64d6dae3-4aef-4336-b5a2-\
8b9802ad7443"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", ",", 
      RowBox[{"0", "*", "u"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", "*", "u"}], ",", "u"}], "}"}]}], "}"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.754169301420265*^9, 3.754169334556253*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"020bec58-d7a0-465b-b939-0cbbd49f193c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"u1", "u2", "u3"},
         {"u4", "u5", "u6"},
         {"u7", "u8", "u9"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"u1", "u2", "u3"},
         {"u4", "u5", "u6"},
         {"u7", "u8", "u9"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.754169313358815*^9, 3.7541693353851347`*^9}, 
   3.7542518747509937`*^9, {3.757902837692068*^9, 3.757902860948678*^9}, 
   3.761496610808786*^9, {3.7615009491591587`*^9, 3.761500966598514*^9}, 
   3.761501011543683*^9, 3.76150104746229*^9},
 CellLabel->
  "Out[308]//MatrixForm=",ExpressionUUID->"9e0d7e1b-8190-436e-825b-\
2a7e5fd75523"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u", ".", "p"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.754178879115097*^9, 3.754178889793736*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"28f8787b-5363-4970-ba5a-7a7609a77673"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"p1", " ", "u1"}], "+", 
        RowBox[{"p2", " ", "u2"}], "+", 
        RowBox[{"p3", " ", "u3"}]}]},
      {
       RowBox[{
        RowBox[{"p1", " ", "u4"}], "+", 
        RowBox[{"p2", " ", "u5"}], "+", 
        RowBox[{"p3", " ", "u6"}]}]},
      {
       RowBox[{
        RowBox[{"p1", " ", "u7"}], "+", 
        RowBox[{"p2", " ", "u8"}], "+", 
        RowBox[{"p3", " ", "u9"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.754178890391576*^9, 3.754251874773497*^9, {3.757902837740747*^9, 
   3.757902860984252*^9}, 3.761496610865967*^9, {3.761500949187029*^9, 
   3.761500966627473*^9}, 3.761501011570333*^9, 3.7615010474906273`*^9},
 CellLabel->
  "Out[309]//MatrixForm=",ExpressionUUID->"5b94503c-261a-4aa1-b2e9-\
91f39b2222c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"p", ".", "r", ".", "u"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7542518828661747`*^9, 3.7542519363519363`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"7abab957-71b4-4b9b-8e57-91bf1817dcdb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r1"}], "+", 
           RowBox[{"p2", " ", "r4"}], "+", 
           RowBox[{"p3", " ", "r7"}]}], ")"}], " ", "u1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r2"}], "+", 
           RowBox[{"p2", " ", "r5"}], "+", 
           RowBox[{"p3", " ", "r8"}]}], ")"}], " ", "u4"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r3"}], "+", 
           RowBox[{"p2", " ", "r6"}], "+", 
           RowBox[{"p3", " ", "r9"}]}], ")"}], " ", "u7"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r1"}], "+", 
           RowBox[{"p2", " ", "r4"}], "+", 
           RowBox[{"p3", " ", "r7"}]}], ")"}], " ", "u2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r2"}], "+", 
           RowBox[{"p2", " ", "r5"}], "+", 
           RowBox[{"p3", " ", "r8"}]}], ")"}], " ", "u5"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r3"}], "+", 
           RowBox[{"p2", " ", "r6"}], "+", 
           RowBox[{"p3", " ", "r9"}]}], ")"}], " ", "u8"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r1"}], "+", 
           RowBox[{"p2", " ", "r4"}], "+", 
           RowBox[{"p3", " ", "r7"}]}], ")"}], " ", "u3"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r2"}], "+", 
           RowBox[{"p2", " ", "r5"}], "+", 
           RowBox[{"p3", " ", "r8"}]}], ")"}], " ", "u6"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", "r3"}], "+", 
           RowBox[{"p2", " ", "r6"}], "+", 
           RowBox[{"p3", " ", "r9"}]}], ")"}], " ", "u9"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.754251894373914*^9, 3.754251936676002*^9}, {
   3.7579028377908697`*^9, 3.757902861019812*^9}, 3.761496610893221*^9, {
   3.761500949214569*^9, 3.761500966656938*^9}, 3.761501011596511*^9, 
   3.7615010475189657`*^9},
 CellLabel->
  "Out[310]//MatrixForm=",ExpressionUUID->"6cd105d3-5729-4044-99bf-\
3b820d558a33"]
}, Open  ]]
},
WindowSize->{1861, 1025},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 175, 3, 31, "Input",ExpressionUUID->"f3551e42-c888-408e-9b4a-7deb4bd0c2c6"],
Cell[736, 25, 634, 15, 55, "Input",ExpressionUUID->"4dc99fde-3394-4374-a719-d7cedd8da85c"],
Cell[1373, 42, 3763, 99, 170, "Input",ExpressionUUID->"2e9faad2-c0fc-48b2-9fb2-d5691a481547"],
Cell[CellGroupData[{
Cell[5161, 145, 306, 5, 31, "Input",ExpressionUUID->"a4b124a9-47ab-45bb-ad64-486218d220ad"],
Cell[5470, 152, 756, 17, 37, "Output",ExpressionUUID->"9804a146-abc8-46b7-ae7d-20ae0b3367fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6263, 174, 209, 3, 31, "Input",ExpressionUUID->"614bc305-be08-4e1f-a5d0-4fd9f5c6933c"],
Cell[6475, 179, 665, 14, 35, "Output",ExpressionUUID->"d3ff305c-a606-4fba-9364-d42a9a4c8e4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7177, 198, 339, 7, 31, "Input",ExpressionUUID->"e25b27fd-2b3a-42cd-9659-899d6a921f15"],
Cell[7519, 207, 2118, 62, 95, "Output",ExpressionUUID->"8cd06397-cd68-4e4d-852f-9327d3d97a35"]
}, Open  ]],
Cell[9652, 272, 638, 16, 64, "Input",ExpressionUUID->"9925d819-6e14-4f4d-a44f-65e050447c68"],
Cell[CellGroupData[{
Cell[10315, 292, 1428, 37, 101, "Input",ExpressionUUID->"e59d97cc-d4f2-4957-8e3e-f9805f8e25eb"],
Cell[11746, 331, 1070, 17, 35, "Output",ExpressionUUID->"19d0427b-862d-41e4-a3e6-557bf996f1bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12853, 353, 509, 10, 55, "Input",ExpressionUUID->"d3a25e56-78da-4edc-ae63-ec8d1d1f846f"],
Cell[13365, 365, 700, 12, 35, "Output",ExpressionUUID->"31b94d21-08a7-4d90-a4e0-8a0dd1733620"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14102, 382, 179, 3, 31, "Input",ExpressionUUID->"1ba4455c-b4ba-4506-830e-80ba1223ffb5"],
Cell[14284, 387, 283, 6, 35, "Output",ExpressionUUID->"30c7ee84-cef6-4a08-adb7-4dd98db5bc75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14604, 398, 206, 4, 31, "Input",ExpressionUUID->"ca434772-4896-4563-bda4-8d8ce1619013"],
Cell[14813, 404, 404, 7, 35, "Output",ExpressionUUID->"cb369bfc-1a97-4ec4-ac1c-b08a23da9db4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15254, 416, 207, 4, 31, "Input",ExpressionUUID->"5024fabe-3a4f-4fb0-b573-61f770e51167"],
Cell[15464, 422, 402, 7, 35, "Output",ExpressionUUID->"a2ef50db-f368-467a-bc3e-abe5f4368f6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15903, 434, 214, 4, 31, "Input",ExpressionUUID->"2ed1cf78-afa3-458a-bd99-c09442ada98e"],
Cell[16120, 440, 398, 7, 35, "Output",ExpressionUUID->"0a9d8be7-232b-4b00-89f9-7f2928580908"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16555, 452, 243, 5, 31, "Input",ExpressionUUID->"5527f0df-894f-41be-a4db-b9a0f54201a0"],
Cell[16801, 459, 995, 26, 83, "Output",ExpressionUUID->"34514324-516a-497c-af04-c62ea930b5ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17833, 490, 382, 9, 31, "Input",ExpressionUUID->"09589082-58e7-4704-91bc-f621a037e9db"],
Cell[18218, 501, 1045, 26, 83, "Output",ExpressionUUID->"34b7a7e5-d4b5-46fe-b253-f2772db9da01"]
}, Open  ]],
Cell[19278, 530, 4470, 154, 561, "Input",ExpressionUUID->"877e3692-50bf-44cd-a2ff-fb92977a6f4b"],
Cell[CellGroupData[{
Cell[23773, 688, 299, 7, 31, "Input",ExpressionUUID->"baf6e5d5-4909-4971-b980-02ae16a36d0f"],
Cell[24075, 697, 769, 15, 35, "Output",ExpressionUUID->"2a129098-a750-467d-85f1-1362ba4833b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24881, 717, 179, 3, 31, "Input",ExpressionUUID->"d403d39c-a17d-4050-9587-8f1a60c2302c"],
Cell[25063, 722, 748, 15, 35, "Output",ExpressionUUID->"6d9c10d6-7f32-43bb-b906-a3561384532b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25848, 742, 288, 5, 31, "Input",ExpressionUUID->"09640e9b-3a2e-461a-b824-efb807472d38"],
Cell[26139, 749, 3461, 56, 373, "Output",ExpressionUUID->"da929534-bdac-49b5-ab03-b84789e478ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29637, 810, 351, 7, 31, "Input",ExpressionUUID->"bff6149e-7164-4f63-b6a3-5f077ed2d343"],
Cell[29991, 819, 575, 16, 35, "Output",ExpressionUUID->"7d2f36f5-2647-45c6-b269-63f482ff46fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30603, 840, 1110, 22, 55, "Input",ExpressionUUID->"a79160d1-9306-41cd-8dd0-6ee457e539d3"],
Cell[31716, 864, 2597, 74, 92, "Output",ExpressionUUID->"0977cdcf-75e8-431d-a5b7-4028fc974e12"]
}, Open  ]],
Cell[34328, 941, 549, 13, 31, "Input",ExpressionUUID->"9db95a6c-dbae-4168-ad08-077575ae859a"],
Cell[CellGroupData[{
Cell[34902, 958, 213, 3, 31, "Input",ExpressionUUID->"50a5663d-8ce4-484f-b671-150046b3bc84"],
Cell[35118, 963, 4370, 114, 82, "Output",ExpressionUUID->"5da31b07-642a-4b3e-a467-11ddd52f7382"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39525, 1082, 203, 3, 31, "Input",ExpressionUUID->"0727f47a-0ba5-4f08-80bb-7e03dd40e9d3"],
Cell[39731, 1087, 1387, 23, 88, "Output",ExpressionUUID->"653f8953-4e1b-430e-905c-1f5647f54f23"]
}, Open  ]],
Cell[41133, 1113, 1064, 30, 101, "Input",ExpressionUUID->"641b9b7c-c0d1-4fdd-a114-cd203beee37c"],
Cell[CellGroupData[{
Cell[42222, 1147, 210, 4, 31, "Input",ExpressionUUID->"5a036987-a83c-4d10-a11b-4d495f1efe34"],
Cell[42435, 1153, 960, 25, 83, "Output",ExpressionUUID->"e65af887-3047-4029-b62f-5eb1a7e45fa1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43432, 1183, 208, 4, 31, "Input",ExpressionUUID->"82813bdd-0a12-41c4-bf65-a7f82417e3b0"],
Cell[43643, 1189, 959, 25, 83, "Output",ExpressionUUID->"6a85bb33-415c-4674-b7b1-3d65198ce486"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44639, 1219, 320, 8, 31, "Input",ExpressionUUID->"43b6e64b-668b-4381-a8ef-36c5049e0b01"],
Cell[44962, 1229, 2942, 84, 83, "Output",ExpressionUUID->"64d6dae3-4aef-4336-b5a2-8b9802ad7443"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47941, 1318, 414, 13, 31, "Input",ExpressionUUID->"020bec58-d7a0-465b-b939-0cbbd49f193c"],
Cell[48358, 1333, 3355, 88, 137, "Output",ExpressionUUID->"9e0d7e1b-8190-436e-825b-2a7e5fd75523"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51750, 1426, 231, 5, 31, "Input",ExpressionUUID->"28f8787b-5363-4970-ba5a-7a7609a77673"],
Cell[51984, 1433, 1365, 39, 83, "Output",ExpressionUUID->"5b94503c-261a-4aa1-b2e9-91f39b2222c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53386, 1477, 245, 5, 31, "Input",ExpressionUUID->"7abab957-71b4-4b9b-8e57-91bf1817dcdb"],
Cell[53634, 1484, 2918, 84, 83, "Output",ExpressionUUID->"6cd105d3-5729-4044-99bf-3b820d558a33"]
}, Open  ]]
}
]
*)

